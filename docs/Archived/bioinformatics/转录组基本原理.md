# 1 数据表
## 1.1 样本信息表
**每一行是一个样本，每一列是一个表型特征（临床信息、表型特征、生化指标等）**

## 1.2 基因信息表
**每一行是一个基因；每一列是一个信息，通过下载、注释得到**

## 1.3 表达矩阵
**每一行是一个基因，每一列是一个样本，通过表达芯片，RNA-seq 得到**

![[Pasted image 20230907141940.png]] 



**RNAseq 在同一个样本中比较两个不同基因的表达时不行的**
**两个样本比较同一个基因也是不行的**

***是看每个样本中不同基因的表达情况***
# 2 RNAseq
## 2.1 第一步比对 Spliced alignment

  ### 2.1.1 比对到参考基因组
1. Hisat2
2. STAR
  ### 2.1.2 比对到转录组
Bowtie2
## 2.2 第二步表达定量

> 生物学重复：换个组织测。即在不同的样本中测量重复，看是否有相同表达或者现象

>聚类分析和 WGCNA ：探索基因与表型的关系

![[Pasted image 20230908114350.png]]

## 第三步标准化 Normalization
**得到的矩阵中，基因长度不同，测序深度不同，所以需要对其进行一个标准化以衡量差异表达**

 ### RPKM
 先除以长度，再除以 total reads 
 这样下来第二次相当于初始化了，除以的是未经第一步处理的总 reads
 现在基本认定这个方法不正确，但是起最后结果并没有错

 ### TPM
先除长度，再除以经长度标准后的 reads 

### 特殊情况
**处理样品中，有一个基因 G5 的表达异常高，大量的 reads 都被它占有，导致其它基因的相对表达量降低，即有其它基因在两个样本中的表达次数相同，TPM 也有明显差异**

![[Pasted image 20230908112504.png]]

***解决办法***：
1. 内参基因：不同组织、不同条件下表达恒定的看家基因
2. 假设大多基因是没有差异表达的。**Trimmed Mean of M-values**（TMM）

